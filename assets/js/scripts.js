var artworks={genericAnimations:function(element){$("svg.gsap-enabled",element).each(function(){var $svg=$(this);if($svg.data("timeline")){$svg.data("timeline").play();return}$svg.data("originalHTML",$("<div></div>").append($svg.clone()).html());var $animations=$("animate",$svg);var timeline=new TimelineMax({repeat:-1});$animations.each(function(i){var $path=$(this).parent();var animate=this;var propsFrom={ease:Linear.easeNone};var propsTo={ease:Linear.easeNone};var tween;propsFrom[animate.getAttribute("attributeName")]=parseInt(animate.getAttribute("from"),10);propsTo[animate.getAttribute("attributeName")]=parseInt(animate.getAttribute("to"),10);tween=TweenMax.fromTo($path,parseFloat(animate.getAttribute("dur"),0),propsFrom,propsTo).repeat(-1);timeline.add(tween,0);$(this).remove()});$svg.data("timeline",timeline)})}};window.runAnimations=function(context){for(key in artworks){artworks[key](context)}};$(function(){var SCROLL_SPEED=1e3;var SCROLL_BUFFER=450;var HIW_SECTION_INDEX=$(".fullpage-section.how-it-works").index()+1;var HIW_SLIDES=$(".slide").length;var currentSlide=0;var currentIndex=0;var lastSectionChanged=new Date;var clickTransition=false;var $nav;var svgs={};var tooltips;teardownImagesForSection($("#fullpage"));preloadAllImages();willShowSection(1);tooltips=$(".fullpage-section").map(function(){return $(this).data("title")}).get();if(window.env.mobile||window.env.ieMode){$(".animate-me").addClass("animate-in")}else{$(".animate-me").removeClass("animate-in").addClass("animate-out")}$("#fullpage").fullpage({sectionSelector:".fullpage-section",slideSelector:".slide",navigation:true,navigationPosition:"right",navigationTooltips:tooltips,showActiveTooltip:true,scrollOverflow:true,scrollOverflowOptions:{scrollbars:false},scrollingSpeed:SCROLL_SPEED,loopHorizontal:false,normalScrollElements:".normal-scroll",touchSensitivity:15,afterLoad:function(anchorLink,index){didLeaveSection(currentIndex);currentIndex=index},afterSlideLoad:function(anchorLink,index,slideAnchor,slideIndex){currentSlide=slideIndex},onLeave:function(index,nextIndex,direction){if(preventDoubleScroll(index,nextIndex,direction)){return false}if(overrideScroll(direction)){return false}willShowSection(nextIndex);$nav.removeClass("active-"+index).addClass("active-"+nextIndex)},onSlideLeave:function(anchorLink,index,slideIndex,direction,nextSlideIndex){$(".fullpage-section.how-it-works").removeClass("slide-"+slideIndex).addClass("slide-"+nextSlideIndex)},afterRender:function(){$nav=$("#fp-nav");$nav.on("mousedown touchdown",function(){clickTransition=true}).on("mouseup touchup",function(){setTimeout(function(){clickTransition=false},100)});$nav.append('<span class="shuttle"></span><span class="shuttle"></span>');var $contact=$('<span href="/#make-contact" class="contact-link">CONTACT</span>').on("click",function(){$.fn.fullpage.moveTo("make-contact")}).appendTo($nav);$nav.find("li:last-child").on("mouseenter",function(){$contact.css("opacity","0")}).on("mouseleave",function(){$contact.css("opacity","")});$nav.find(".fp-tooltip").each(function(){var $tooltip=$(this);$tooltip.html($('<span class="fp-tooltip-text"></span>').text($tooltip.text()))});$nav.find(".fp-tooltip").append('<span class="ie-click-target"></span>');$("#fullpage").addClass("animate-in")}});window.fullpage=$.fn.fullpage;if(window.env.mobile){$(".section-connect .connect-module").on("click",function(){$(this).toggleClass("active").siblings().removeClass("active")})}function didLeaveSection(index){if(!index){return}index-=1;var $section=$($(".fullpage-section")[index]);if(!window.env.mobile&&!window.env.ieMode){$(".animate-me",$section).removeClass("animate-in").addClass("animate-out")}teardownImagesForSection($section)}function willShowSection(index){var $section=index;if(typeof $section==="number"){index-=1;$section=$($(".fullpage-section")[index])}if($section.data("logo")){$("#nav-logo").css({opacity:1,visibility:"visible"})}else{$("#nav-logo").css({opacity:0,visibility:"hidden"})}if($section.find(".fp-scrollable").length){$section.find(".fp-tableCell").addClass("scrollable")}if($section.data("inverted")){$(".button, .global-nav, #fp-nav").addClass("inverted")}else{$(".inverted").removeClass("inverted")}$(".nav-home").hide();var scroller=$(".fp-scrollable",$section).data("iscrollInstance");if(scroller){scroller.scrollTo(0,0)}setupImagesForSection($section);if(!window.env.mobile&&!window.env.ieMode){$(".animate-me",$section).removeClass("animate-out").addClass("animate-in")}}function preventDoubleScroll(index,nextIndex){var now=new Date;var delta=now.getTime()-lastSectionChanged.getTime();if(Math.abs(index-nextIndex)<=1&&delta<SCROLL_SPEED+SCROLL_BUFFER){return true}lastSectionChanged=now;return false}function overrideScroll(direction){var scrollingDown=direction==="down";var firstSlide=currentSlide===0;var lastSlide=currentSlide===HIW_SLIDES-1;if(clickTransition||currentIndex!==HIW_SECTION_INDEX||lastSlide&&scrollingDown||firstSlide&&!scrollingDown){return false}if(scrollingDown){$.fn.fullpage.moveSlideRight()}else{$.fn.fullpage.moveSlideLeft()}return true}function preloadAllImages(){var $loaders=$('<div class="lazy-loaders"></div>').appendTo("body").css({"max-height":"1px",overflow:"visible"});$("*[lazy-src]").each(function(){var $image=$(this);var src=$image.attr("lazy-src");var $loader;if($image.is("img")){$loader=$image}else{$loader=$("<img />").appendTo($loaders)}$loader.attr("src",src).on("load.lazypreload",function(){removeLoader($loader)}).on("error.lazypreload",function(){removeLoader($loader)})});function removeLoader($loader){if($loader.closest(".lazy-loaders").length){$loader.remove()}else{$loader.off("load.lazypreload error.lazypreload");if(!window.env.ieMode){$loader.css("height",$loader.height()+"px")}if(!$loader.closest(".fullpage-section.active").length){$loader.attr("src","")}}}}function teardownImagesForSection($section){$section.find("*:not(img)[lazy-src]").css("background-image","none");$section.find("img[lazy-src]").each(function(){var $image=$(this);$image.attr("src","")});$("svg",$section).each(function(){var $svg=$(this);if($svg.data("timeline")){$svg.data("timeline").pause();return}var id="svg-"+Math.round(Math.random()*1e5);var holder=$('<div class="svg-holder"></div>').attr("id",id).css({height:$svg.height()+"px",display:"block",width:"100%"});svgs[id]=$svg.data("originalHTML")||$("<div></div>").append($svg.clone()).html();$svg.replaceWith(holder)})}function setupImagesForSection($section){$section.find("*[lazy-src]").each(function(){var $image=$(this);var src=$image.attr("lazy-src");if($image.is("img")){$image.attr("src",src)}else if($image.is("object")){$image.attr("data",src)}else{$image.css("background-image","url("+src+")")}});$(".svg-holder",$section).each(function(){var $holder=$(this);var id=$holder.attr("id");$holder.replaceWith($(svgs[id]));delete svgs[id]});window.runAnimations($section)}});
